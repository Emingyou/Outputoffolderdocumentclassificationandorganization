# 文件批量移动处理工具

## 一、软件简介

**文件格式筛选复制工具**是一款轻量级图形界面工具，旨在帮助用户快速按照文件格式、文件名特征等条件从指定目录中筛选文件，并批量复制到目标文件夹。工具支持保留原目录的子文件夹结构，适用于文件整理、格式分类备份、特定文件提取等场景。

核心特点：
- 基于Python开发，界面简洁直观，支持中文显示
- 无需安装，直接运行（需Python 3.x环境）
- 灵活的筛选规则（包含/排除指定格式、文件名关键词匹配）
- 实时日志记录与进度展示，操作过程可追溯
- 支持最近文件夹记忆，提升重复操作效率


## 二、界面元素说明
<img width="748" height="536" alt="image" src="https://github.com/user-attachments/assets/9aff58d2-dbd4-4ec8-b4d9-55cc16459002" />

工具界面分为多个功能区域，各元素功能如下：

| 区域          | 元素名称               | 说明                                                                 |
|---------------|------------------------|----------------------------------------------------------------------|
| 文件夹选择区  | 源文件夹输入框         | 显示当前选中的源文件夹路径，可手动输入或通过"浏览"按钮选择             |
|               | 目标文件夹输入框       | 显示当前选中的目标文件夹路径，可手动输入或通过"浏览"按钮选择           |
|               | 浏览...按钮            | 点击打开文件夹选择对话框，分别用于选择源文件夹和目标文件夹             |
| 最近文件夹区  | 最近文件夹按钮         | 显示最近使用过的5个文件夹（点击可快速设置为源/目标文件夹，优先填充空输入框） |
| 筛选选项区    | 筛选模式单选框         | 包含"包含指定格式"（仅复制符合格式的文件）和"排除指定格式"（复制除指定格式外的文件） |
|               | 文件格式输入框         | 用于输入筛选的文件格式（多格式用逗号分隔，如`txt,docx`或`.pdf,.jpg`）  |
|               | 常用格式按钮           | 快捷添加`.txt` `.docx` `.xlsx`等常见格式（自动去重）                  |
| 高级选项区    | 包含子文件夹复选框     | 勾选后递归处理源文件夹下的所有子文件夹（保留原目录结构）               |
|               | 覆盖已存在的文件复选框 | 勾选后目标文件夹中同名文件会被覆盖，否则跳过                          |
| 文件名筛选区  | 文件名包含输入框       | 输入文本后仅复制文件名（不区分大小写）包含该文本的文件（空则不筛选）   |
| 进度与状态区  | 进度条                 | 显示文件复制的进度百分比                                             |
|               | 状态标签               | 显示当前操作状态（如"就绪"、"正在复制 3/10 文件"）                    |
| 操作按钮区    | 开始复制按钮           | 启动文件筛选与复制流程（点击后在新线程执行，不冻结界面）               |
|               | 停止按钮               | 中途终止复制操作（完成当前文件后停止）                               |
|               | 清空日志按钮           | 清除操作日志区域的内容                                               |
| 日志展示区    | 日志文本框             | 显示详细操作记录（含时间戳），包括复制成功、跳过、失败的文件信息       |


## 三、核心功能说明

1. **灵活的格式筛选**  
   支持两种筛选模式：  
   - 包含模式：仅复制符合输入格式列表的文件（如仅保留`.jpg` `.png`图片）  
   - 排除模式：复制除输入格式外的所有文件（如排除`.tmp`临时文件）  

2. **目录结构保留**  
   勾选"包含子文件夹"后，工具会递归处理源文件夹的所有子目录，并在目标文件夹中重建相同的目录结构，避免文件混乱。

3. **文件名精准筛选**  
   通过"文件名包含"输入框可进一步缩小范围，仅复制名称中包含指定文本的文件（如筛选所有含"报告"的`.docx`文件）。

4. **最近文件夹记忆**  
   自动记录最近使用的10个文件夹，点击即可快速复用，减少重复选择路径的操作。

5. **安全复制与日志追踪**  
   - 复制文件时保留原文件元数据（创建时间、修改时间等）  
   - 详细日志记录每个文件的处理结果（成功/跳过原因/失败报错），便于追溯  
   - 支持中途停止，避免误操作导致的资源浪费


## 四、操作步骤

### 1. 准备工作  
确保已安装Python 3.x环境（推荐3.6及以上版本），下载程序文件后，通过命令行执行：  
```bash
python 文件夹文档分类输出-图形化.py
```


### 2. 基本操作流程  

#### 步骤1：选择源文件夹和目标文件夹  
- 点击"源文件夹"右侧的"浏览..."按钮，选择需要筛选文件的目录  
- 点击"目标文件夹"右侧的"浏览..."按钮，选择文件复制的目标目录（不存在会自动创建）  
- （可选）点击"最近文件夹"区域的按钮，快速填充源/目标路径  


#### 步骤2：设置筛选条件  
- **选择筛选模式**：点击"包含指定格式"或"排除指定格式"单选框  
- **设置文件格式**：  
  - 直接在输入框中填写（如`pdf,doc,xls`，带不带点均可）  
  - 点击常用格式按钮（如`.txt`）快速添加（自动去重）  
- **（可选）文件名筛选**：在"文件名包含"输入框中填写关键词（如"2023"）  


#### 步骤3：配置高级选项  
- 若需要处理子文件夹：勾选"包含子文件夹"  
- 若需要覆盖目标文件：勾选"覆盖已存在的文件"（默认不覆盖，会跳过）  


#### 步骤4：开始复制  
- 点击"开始复制"按钮，工具会在后台执行操作：  
  - 进度条显示整体进度  
  - 状态标签实时更新当前处理的文件数量  
  - 日志区域显示每个文件的处理结果（含时间戳）  


#### 步骤5：查看结果  
- 操作完成后，会弹出统计窗口（总处理数、成功数、跳过数、失败数）  
- 日志区域可查看详细记录，点击"清空日志"可清除记录  


#### 步骤6：中途停止（可选）  
- 点击"停止"按钮，工具会在完成当前文件复制后终止操作，并显示已处理统计  


## 五、注意事项  

1. 源文件夹和目标文件夹不能为同一目录，否则会提示错误  
2. 复制失败可能因权限不足、文件被占用等原因，日志会显示具体错误信息  
3. 大型文件或大量文件复制可能需要较长时间，请耐心等待，避免强制关闭程序  
4. 最近文件夹记录保存在程序同目录的`recent_folders.txt`中，删除该文件会清空记录  
5. 支持中文路径和文件名，无需担心乱码问题  

如有问题或建议，欢迎在GitHub仓库提交issue反馈。
